var onJQAnimationEndHandle=function(option){switch(option.type){case"fadeIn":this.removeClass("opacity "+option.ani);break;case"fadeOut":this.hide().removeClass(option.ani);break}if(option.callback){option.callback.call(this)}this.off("webkitAnimationEnd").css({animationDuration:""})};$.fn.extend({fi:function(option){var _this=this;var options={ani:"ani-fadeIn",duration:"500",callback:undefined,type:"fadeIn"};if(option){jQuery.extend(options,option)}this.on("webkitAnimationEnd",function(e){e.stopPropagation();onJQAnimationEndHandle.call(_this,options)}).css({animationDuration:options.duration+"ms"}).addClass("opacity "+options.ani).show();return this},fo:function(option){var _this=this;var options={ani:"ani-fadeOut",duration:"500",callback:undefined,type:"fadeOut"};if(option){jQuery.extend(options,option)}this.on("webkitAnimationEnd",function(e){e.stopPropagation();onJQAnimationEndHandle.call(_this,options)}).css({animationDuration:options.duration+"ms"}).addClass(options.ani);return this}});if(Object.assign===undefined){(function(){Object.assign=function(target){"use strict";if(target===undefined||target===null){throw new TypeError("Cannot convert undefined or null to object")}var output=Object(target);for(var index=1;index<arguments.length;index++){var source=arguments[index];if(source!==undefined&&source!==null){for(var nextKey in source){if(Object.prototype.hasOwnProperty.call(source,nextKey)){output[nextKey]=source[nextKey]}}}}return output}})()}var Utils=new function(){this.ImageLoader=function ImageLoader(){this.total=0;this.haveload=0;this.percent=0;this.complete=false;this.version="?v1"};this.lazyLoad=function(){var a=$(".lazy");var len=a.length;var imgObj;var Load=function(){for(var i=0;i<len;i++){imgObj=a.eq(i);imgObj.attr("src",imgObj.attr("data-src"))}};Load()};this.browser=function(t){var u=navigator.userAgent;var u2=navigator.userAgent.toLowerCase();var p=navigator.platform;var browserInfo={trident:u.indexOf("Trident")>-1,presto:u.indexOf("Presto")>-1,webKit:u.indexOf("AppleWebKit")>-1,gecko:u.indexOf("Gecko")>-1&&u.indexOf("KHTML")==-1,mobile:!!u.match(/AppleWebKit.*Mobile.*/),ios:!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:u.indexOf("Android")>-1||u.indexOf("Linux")>-1,iPhone:u.indexOf("iPhone")>-1,iPad:u.indexOf("iPad")>-1,webApp:u.indexOf("Safari")==-1,iosv:u.substr(u.indexOf("iPhone OS")+9,3),weixin:u2.match(/MicroMessenger/i)=="micromessenger",taobao:u.indexOf("AliApp(TB")>-1,win:p.indexOf("Win")==0,mac:p.indexOf("Mac")==0,xll:p=="X11"||p.indexOf("Linux")==0,ipad:navigator.userAgent.match(/iPad/i)!=null?true:false};return browserInfo[t]};this.g=function(id){return document.getElementById(id)};this.limitNum=function(obj){var value=$(obj).val();var length=value.length;if(length>11){value=value.substring(0,11);$(obj).val(value)}}};Object.assign(Utils.ImageLoader.prototype,{load:function(urls,onEveryLoad,onComplete){var result={0:[]};this.total=urls.length;var _this=this;start();function onLoad(e){if(Object.prototype.hasOwnProperty.call(urls[_this.haveload],"group")){var group=urls[_this.haveload].group;if(result[group]instanceof Array==false){result[group]=[]}result[group].push(this)}else{result[0].push(this)}_this.haveload++;_this.percent=Math.floor(_this.haveload/_this.total*100);onEveryLoad(_this.percent);this.onload=null;if(_this.percent==100){_this.complete=true;onComplete(result);return}var img=new Image;img.onload=onLoad;img.src=urls[_this.haveload].url+_this.version}function start(){var img=new Image;img.onload=onLoad;img.src=urls[_this.haveload].url+_this.version}}});var Media=new function(){this.mutedEnd=false;this.WxMediaInit=function(){var _self=this;if(!Utils.browser("weixin")){this.mutedEnd=true;return}if(!Utils.browser("iPhone")){_self.mutedEnd=true;return}document.addEventListener("WeixinJSBridgeReady",function(){var $media=$(".iosPreload");$.each($media,function(index,value){_self.MutedPlay(value["id"]);if(index+1==$media.length){_self.mutedEnd=true}})},false)};this.MutedPlay=function(string){var str=string.split(",");var f=function(id){var media=Utils.g(id);media.volume=0;media.play();media.pause();media.volume=1;media.currentTime=0};if(!(str.length-1)){f(str[0]);return 0}str.forEach(function(value,index){f(value)})};this.playMedia=function(id){var _self=this;var clock=setInterval(function(){if(_self.mutedEnd){Utils.g(id).play();clearInterval(clock)}},20)}};Media.WxMediaInit();var options={el:"#iCreative",data:{server_data:{is_end:!!parseInt($("#is_end").val()),have_guanzhu:!!parseInt($("#have_guanzhu").val()),isVip:!!parseInt($("#is_vip").val()),goRegist:!!parseInt($("#goRegist").val()),haveFill:!!parseInt($("#haveFill").val()),prizeType:parseInt($("#prizeType").val()),province:[{province:"江西省"},{province:"浙江省"},{province:"江苏省"}],city:[{city:"杭州市"},{city:"嘉兴市"},{city:"温州市"}],address:[{id:"1",name:"门店名称"},{id:"2",name:"门店名称"},{id:"3",name:"门店名称"}],name:"",tel:"",select_province:"",select_city:"",select_address:"",shop_id:0,myInfo:{province:"",city:"",shop:""}},ploading:{visible:true},pwebgl:{visible:false},p1:{visible:false},p2:{visible:false},pfill:{visible:false},pend:{visible:false},pquery:{visible:false},paddress:{visible:false},pvideo:{visible:false},prule:{visible:false},hpwarn:{visible:false},pwait:{visible:false},pages:{p1:"p1",p2:"p2"},router:[]},methods:{pfill_btn_submit:function(){var number=this.server_data.tel;var name=this.server_data.name;var patt=/^1(3|4|5|7|8)\d{9}$/;if(name==""){this.pmask.type=this.pmask.choice.normal;this.pmask.content="请输入姓名";this.pmask.visible=true;return}if(!patt.test(number)){this.pmask.type=this.pmask.choice.normal;this.pmask.content="请输入正确的手机号";this.pmask.visible=true;return}if(this.server_data.select_province==""){this.pmask.type=this.pmask.choice.normal;this.pmask.content="请选择省份";this.pmask.visible=true;return}if(this.server_data.select_city==""){this.pmask.type=this.pmask.choice.normal;this.pmask.content="请选择城市";this.pmask.visible=true;return}if(this.server_data.select_address==""){this.pmask.type=this.pmask.choice.normal;this.pmask.content="请选择门店";this.pmask.visible=true;return}_uploadData.fillInfo()},onPfillProvinceChangeHandle:function(e){console.log(this.server_data.select_province)},onPfillCityChangeHandle:function(e){console.log(this.server_data.select_city)},onPfillAddressChangeHandle:function(e){this.server_data.shop_id=e.target.selectedOptions[0].getAttribute("shopid");console.log(this.server_data.select_address)},onPaddress_btn_xx:function(){this.paddress.visible=false},back:function(){var len=this.router.length;if(len>0){var page=this.router[len-1];this[page].visible=true;this.router.splice(len-1,1)}}},delimiters:["$[","]"]};var vm=new Vue(options);var main=new function(){this.touch={ScrollObj:undefined,isScroll:false,limitUp:0,limitDown:undefined,overlimit:false,lastX:0,lastY:0,newX:0,newY:0,delta_X:0,delta_Y:0,scrollY:0,touchAllow:true,fingerNumber:0,distance:0,angle:0,delta_angle:0,time:0,offsetTime:0};this.bgm={obj:document.getElementById("bgm"),id:"bgm",isPlay:false,button:$(".music-btn")};this.V={id:"video",currentTime:0,isPlay:false,obj:document.getElementById("video")};this.assetsUrl="assets/";this.picUrl=this.assetsUrl+"images/";this.ImageList=[{url:this.picUrl+"weile.png",group:"clouds"},{url:this.picUrl+"phone.png",group:"scene"}];this.RAF=undefined};main.init=function(){};main.start=function(){var loader=new ImageLoader;loader.load(this.ImageList,function(progress){console.log(progress)},function(result){console.log(result)})};main.loadCallBack=function(){};main.prule=function(){$(".P_rule").fi();main.scrollInit(".rule-txt",0)};main.prulelaeve=function(){$(".P_rule").fo(function(){$(".rule-txt")[0].style.webkitTransform="translate3d(0,0,0)"})};main.scrollInit=function(selector){this.touch.ScrollObj=$(selector);this.touch.container=$(selector).parent();this.touch.StartY=0;this.touch.NewY=0;this.touch.addY=0;this.touch.scrollY=0;this.touch.limitDown=this.touch.ScrollObj.height()<this.touch.container.height()?0:this.touch.container.height()-this.touch.ScrollObj.height()};main.limitNum=function(obj){var value=obj.value;var length=value.length;if(length>11){value=value.substring(0,11);obj.value=value}};main.playbgm=function(){Media.playMedia(this.bgm.id);this.bgm.button.addClass("ani-bgmRotate");this.bgm.isPlay=true};main.pausebgm=function(){this.bgm.obj.pause();this.bgm.button.removeClass("ani-bgmRotate");this.bgm.isPlay=false};main.startRender=function(){var loop=function(){main.RAF=window.requestAnimationFrame(loop)};loop()};main.stopRender=function(){window.cancelAnimationFrame(main.RAF)};main.addEvent=function(){$(window).on("orientationchange",function(e){if(window.orientation==0||window.orientation==180){vm.hpwarn.visible=false}else if(window.orientation==90||window.orientation==-90){vm.hpwarn.visible=true}})};main.addEvent();